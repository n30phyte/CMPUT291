\RequirePackage[l2tabu, orthodox]{nag}
\documentclass{article}

\usepackage[margin=1.9cm, letterpaper]{geometry}
\usepackage[utf8]{inputenc}
\usepackage{indentfirst}
\usepackage[super]{nth}

\title{CMPUT 291 Mini Project 2 Report}
\date{November 2020}
\author{Cynthia Li (sqli)\\
\and Michael Kwok (mkwok1)}

\begin{document}
\maketitle

\section{Project Overview}
% general overview of system /w small user guide
% high level introduction; may include diagram showing flow of data between diff components

This program utilizes an online MongoDB NoSQL database to store data for posts, votes, and tags. The user interacts with the system by selecting options displayed on screen in each state.

Upon start up, the user may choose to enter a numeric user id. If the user id is valid (contains only numbers), a user report is generated which outlines the number of questions and answers the given user has posted, along with their average scores, then displays the total votes the user has made. Otherwise if a user id was not provided or if the user id is invalid, the program proceeds to the main menu.

In the main menu, the user has the option to post a question, search for questions, or exit the program. In posting a question, the user is asked to enter a title, body, and tags for the post. Upon finishing, the user is taken to view the newly posted question with all its newly generated data that is stored in the database. From there, several options are presented to the user: answer the question, list all answers to the question, vote on the question, and return to the main menu. Answering the question will have an extra line appear to prompt the user to write an answer to the question, to which once the user is finished, will take the user to view the answer inidivudally. The answer view shows the original question of which the answer is responding to, along with the answer itself as well as two actions the user can take: vote or return to main menu.

When the user selects list answers from the question screen, a new table will be displayed on a new screen that shows the accepted answer first (if any exists), and then other answers to the question. The user can select any of the answers listed by their number and go to view the answer individually.

When the user selects the vote action on a question or answer in focus, the score of the post wil increment by 1 if the user is logged in and has not previously voted on the post already. Users who did not provide a user id at the login screen are free to vote without constraint on the post.

If the user chooses to search questions, they will be first prompted to enter keywords delimited by spaces. Upon pressing enter, a table of search results will be displayed in pages of 5. The user can select any of the questions by their numbers in the results or select the see more option to display the next page of search results. The user may also choose to return to menu on the search results page.

\section{Running Instructions}

To install the dependencies of this program, run the following:

\verb|pip3 install -r requirements.txt|

To run the program, the following commands can be used:

\verb|python3.5 phase1.py|

\verb|python3.5 main.py|


Main menu will appear, and user can choose to input their IDs or otherwise.

When creating a new post, each tag must be seperated by a space character

\section{Design}
% detailed design of software w/ focus on components required to deliver major functions of application
% describe reponsibility + interface of each primary function/class + structure + relationships among them

The first phase of the project is written as a simple python script as it's main job is to import the data and no processing. Titles, bodies and tags of posts were indexed as text to improve search speeds at the \nth{2} phase.

In the \nth{2} phase, the user interface and database access functions are split into two files. The main file performs user input handling and displaying the user interface, also navigation between the menus. We rely on \verb|blessed|, a curses library for python to handle clearing the terminal, positioning cursors and adding menu titles. We also use \verb|PrettyTable| to display data. User interface flow is handled by a simple switch/case instead of a heavyweight state machine as we did not require tracking of previous state or anything complicated, and just a list of screens to show. Each state calls into the \verb|Database| class to perform actions as requested by the user.

As previously mentioned, we use a second file. In this second file, we have the \verb|Database| class and related functions such as a function that generates a date string that follows the required format and another that converts a list of tags into the string as stored in the database. The \verb|PyMongo| library was chosen to access the database as it is the official library provided by MongoDB.\@ Both normal queries and aggregation were used in conjunction as required to keep actions performant. As we were not as familiar with NoSQL as we are with SQL, the format of the queries are not consistent (e.g.\ implicit vs explicit \verb|"$and"| queries)


\section{Testing Strategy}
% discuss general strategy for testing w/ scenarios tested + coverage of test cases

% Since each component of the system was developed separately and at different times with the \verb|Database| module coming first, it has a suite of unit tests which currently has about 70\% coverage of the file.

% The \verb|Database| module was mostly developed with Test Driven Development as the main process, which allowed progress to be tracked, and code to be tested as it was written. The output of functions were compared with similar but not identical SQL commands directly to the database to verify that each function ran as expected. Both failure and success situations were tested in test suite, making sure that the specification was provided was followed.

% Integration testing was done manually, by testing each state and part of the interface by hand as setting up automated testing for this part would have been overkill.

% Most bugs found were logic errors from processing the results from SQL, but a few were due to python's weak typing where things were not returned, or certain things were unexpectedly of the \verb|None| type.

\section{Groupwork Breakdown}
% list breakdown of work items among partners; time spent (estimate) + progress made by each partner
% document assuptions made/limitations of code

The group coordinated through WhatsApp direct message, and code was hosted in a private GitHub repository.

\begin{itemize}
    \item Cynthia
          \begin{itemize}
              \item Time estimate: 10 hours
              \item Designed user flow
              \item Implemented most states
              \item Created user interface
              \item Co-authored the report document
          \end{itemize}
    \item Michael
          \begin{itemize}
              \item Time Estimate: 15 hours
              \item Wrote all of \verb|database.py|
              \item Unit tests in \verb|tests.py| and corresponding test data
              \item Implemented the list answers and some of search states
              \item Co-authored the report document
          \end{itemize}
\end{itemize}

\end{document}
